˙q
kD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\DatabaseLayer\DLBase.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 
DatabaseLayer +
{ 
public 

class 
DLBase 
< 
TEntity 
,  
TDTO! %
>% &
:' (
IDLBase) 0
<0 1
TEntity1 8
,8 9
TDTO: >
>> ?
where@ E
TEntityF M
:N O
classP U
{ 
	protected 
WhereHouseContext #
_context$ ,
;, -
	protected 
String 
	tableName "
=# $
$str% '
;' (
	protected 
DbSet 
< 
TEntity 
>  
_dbSet! '
;' (
	protected 
readonly 
IMapper "
_mapper# *
;* +
public 
DLBase 
( 
WhereHouseContext '
context( /
,/ 0
IMapper1 8
mapper9 ?
)? @
{   	
_context!! 
=!! 
context!! 
;!! 
	tableName"" 
="" 
typeof"" 
("" 
TEntity"" &
)""& '
.""' (
Name""( ,
;"", -
_mapper## 
=## 
mapper## 
;## 
}$$ 	
public&& 
bool&& 
Delete&& 
(&& 
TEntity&& "
entity&&# )
)&&) *
{'' 	
var(( 
res(( 
=(( 
$num(( 
;(( 
var)) 
idKey)) 
=)) 
$")) 
{)) 
	tableName)) %
}))% &
$str))& (
"))( )
;))) *
var** 
Id** 
=** 
entity** 
.** 
GetValueByKey** )
<**) *
TEntity*** 1
>**1 2
(**2 3
idKey**3 8
)**8 9
;**9 :
_dbSet++ 
=++ 
_context++ 
.++ 
Set++ !
<++! "
TEntity++" )
>++) *
(++* +
)+++ ,
;++, -
var,, 
record,, 
=,, 
_dbSet,, 
.,,  
Find,,  $
(,,$ %
Guid,,% )
.,,) *
Parse,,* /
(,,/ 0
Id,,0 2
.,,2 3
ToString,,3 ;
(,,; <
),,< =
),,= >
),,> ?
;,,? @
if-- 
(-- 
record-- 
!=-- 
null-- 
)-- 
{.. 
_dbSet// 
.// 
Remove// 
(// 
record// $
)//$ %
;//% &
res00 
=00 
_context00 
.00 
SaveChanges00 *
(00* +
)00+ ,
;00, -
}11 
return22 
(22 
res22 
>22 
$num22 
?22 
true22 "
:22# $
false22% *
)22* +
;22+ ,
}33 	
public55 
IEnumerable55 
<55 
TDTO55 
>55  
GetAll55! '
(55' (
)55( )
{66 	
_dbSet77 
=77 
_context77 
.77 
Set77 !
<77! "
TEntity77" )
>77) *
(77* +
)77+ ,
;77, -
var88 
obj88 
=88 
(88 
TDTO88 
)88 
typeof88 "
(88" #
TDTO88# '
)88' (
.88( )
GetConstructor88) 7
(887 8
new888 ;
Type88< @
[88@ A
$num88A B
]88B C
)88C D
.88D E
Invoke88E K
(88K L
new88L O
object88P V
[88V W
$num88W X
]88X Y
)88Y Z
;88Z [
var>> 
res>> 
=>> 
_mapper>> 
.>> 
Map>> !
<>>! "
List>>" &
<>>& '
TEntity>>' .
>>>. /
,>>/ 0
IEnumerable>>1 <
<>>< =
TDTO>>= A
>>>A B
>>>B C
(>>C D
_dbSet>>D J
.>>J K
ToList>>K Q
(>>Q R
)>>R S
)>>S T
;>>T U
return?? 
res?? 
;?? 
}@@ 	
publicBB 
virtualBB 
TEntityBB 
GetByIDBB &
(BB& '
stringBB' -
IdBB. 0
)BB0 1
{CC 	
_dbSetDD 
=DD 
_contextDD 
.DD 
SetDD !
<DD! "
TEntityDD" )
>DD) *
(DD* +
)DD+ ,
;DD, -
varEE 
resEE 
=EE 
_dbSetEE 
.EE 
FindEE !
(EE! "
GuidEE" &
.EE& '
ParseEE' ,
(EE, -
IdEE- /
)EE/ 0
)EE0 1
;EE1 2
returnFF 
resFF 
;FF 
}GG 	
publicII 
boolII 
InsertII 
(II 
TEntityII "
entityII# )
)II) *
{JJ 	
_dbSetKK 
=KK 
_contextKK 
.KK 
SetKK !
<KK! "
TEntityKK" )
>KK) *
(KK* +
)KK+ ,
;KK, -
_dbSetLL 
.LL 
AddLL 
(LL 
entityLL 
)LL 
;LL 
varMM 
resMM 
=MM 
_contextMM 
.MM 
SaveChangesMM *
(MM* +
)MM+ ,
;MM, -
returnNN 
(NN 
resNN 
>NN 
$numNN 
?NN 
trueNN "
:NN# $
falseNN% *
)NN* +
;NN+ ,
}OO 	
publicQQ 
boolQQ 
UpdateQQ 
(QQ 
TEntityQQ "
entityQQ# )
,QQ) *
stringQQ+ 1
idQQ2 4
)QQ4 5
{RR 	
varSS 
resSS 
=SS 
$numSS 
;SS 
_dbSetTT 
=TT 
_contextTT 
.TT 
SetTT !
<TT! "
TEntityTT" )
>TT) *
(TT* +
)TT+ ,
;TT, -
varUU 
dataUU 
=UU 
_dbSetUU 
.UU 
FindUU "
(UU" #
GuidUU# '
.UU' (
ParseUU( -
(UU- .
idUU. 0
)UU0 1
)UU1 2
;UU2 3
_contextVV 
.VV 
EntryVV 
(VV 
dataVV 
)VV  
.VV  !
CurrentValuesVV! .
.VV. /
	SetValuesVV/ 8
(VV8 9
entityVV9 ?
)VV? @
;VV@ A
resWW 
=WW 
_contextWW 
.WW 
SaveChangesWW &
(WW& '
)WW' (
;WW( )
returnXX 
(XX 
resXX 
>XX 
$numXX 
?XX 
trueXX "
:XX# $
falseXX% *
)XX* +
;XX+ ,
}YY 	
public[[ 
IEnumerable[[ 
<[[ 
TEntity[[ "
>[[" #
GetByKey[[$ ,
([[, -
string[[- 3
key[[4 7
,[[7 8
string[[9 ?
value[[@ E
)[[E F
{\\ 	
IEnumerable^^ 
<^^ 
TEntity^^ 
>^^  
res^^! $
;^^$ %
_dbSet__ 
=__ 
_context__ 
.__ 
Set__ !
<__! "
TEntity__" )
>__) *
(__* +
)__+ ,
;__, -
resbb 
=bb 
_dbSetbb 
.bb 

FromSqlRawbb #
(bb# $
$"bb$ &
$strbb& 4
{bb4 5
	tableNamebb5 >
}bb> ?
$strbb? F
{bbF G
keybbG J
}bbJ K
$strbbK O
{bbO P
valuebbP U
}bbU V
$strbbV W
"bbW X
)bbX Y
;bbY Z
returndd 
resdd 
;dd 
}ff 	
publicgg 
TEntitygg 
GetOneByKeygg "
(gg" #
stringgg# )
keygg* -
,gg- .
stringgg/ 5
valuegg6 ;
)gg; <
{hh 	
TEntityjj 
resjj 
=jj 
nulljj 
;jj 
_dbSetkk 
=kk 
_contextkk 
.kk 
Setkk !
<kk! "
TEntitykk" )
>kk) *
(kk* +
)kk+ ,
;kk, -
resnn 
=nn 
_dbSetnn 
.nn 

FromSqlRawnn #
(nn# $
$"nn$ &
$strnn& 4
{nn4 5
	tableNamenn5 >
}nn> ?
$strnn? F
{nnF G
keynnG J
}nnJ K
$strnnK O
{nnO P
valuennP U
}nnU V
$strnnV W
"nnW X
)nnX Y
.nnY Z
FirstOrDefaultnnZ h
(nnh i
)nni j
;nnj k
returnoo 
resoo 
;oo 
}qq 	
publicrr 
	TableNamerr 
GetOneByKeyWithTyperr ,
<rr, -
	TableNamerr- 6
>rr6 7
(rr7 8
PropertyInforr8 D
proprrE I
,rrI J
TEntityrrK R
entityrrS Y
)rrY Z
whererr[ `
	TableNamerra j
:rrk l
classrrm r
{ss 	
	TableNamett 
restt 
=tt 
nulltt  
;tt  !
varuu 
keyuu 
=uu 
propuu 
.uu 
Nameuu 
;uu  
varvv 
valuevv 
=vv 
propvv 
.vv 
GetValuevv %
(vv% &
entityvv& ,
)vv, -
;vv- .
varww 
tableww 
=ww 
typeofww 
(ww 
	TableNameww (
)ww( )
.ww) *
Nameww* .
;ww. /
varxx 
dbSetxx 
=xx 
_contextxx  
.xx  !
Setxx! $
<xx$ %
	TableNamexx% .
>xx. /
(xx/ 0
)xx0 1
;xx1 2
res{{ 
={{ 
dbSet{{ 
.{{ 

FromSqlRaw{{ "
({{" #
$"{{# %
$str{{% 4
{{{4 5
table{{5 :
}{{: ;
$str{{; C
{{{C D
key{{D G
}{{G H
$str{{H L
{{{L M
value{{M R
}{{R S
$str{{S T
"{{T U
){{U V
.{{V W
FirstOrDefault{{W e
({{e f
){{f g
;{{g h
return|| 
res|| 
;|| 
}~~ 	
public
ÄÄ 
virtual
ÄÄ 
ServiceResult
ÄÄ $
GetByPaging
ÄÄ% 0
(
ÄÄ0 1
int
ÄÄ1 4
page
ÄÄ5 9
,
ÄÄ9 :
int
ÄÄ; >
pageSize
ÄÄ? G
)
ÄÄG H
{
ÅÅ 	
_dbSet
ÇÇ 
=
ÇÇ 
_context
ÇÇ 
.
ÇÇ 
Set
ÇÇ !
<
ÇÇ! "
TEntity
ÇÇ" )
>
ÇÇ) *
(
ÇÇ* +
)
ÇÇ+ ,
;
ÇÇ, -
var
ÉÉ 
totalRecords
ÉÉ 
=
ÉÉ 
_dbSet
ÉÉ %
.
ÉÉ% &
Count
ÉÉ& +
(
ÉÉ+ ,
)
ÉÉ, -
;
ÉÉ- .
var
ÑÑ 
skip
ÑÑ 
=
ÑÑ 
(
ÑÑ 
page
ÑÑ 
-
ÑÑ 
$num
ÑÑ  
)
ÑÑ  !
*
ÑÑ" #
pageSize
ÑÑ$ ,
;
ÑÑ, -
var
ÖÖ 
res
ÖÖ 
=
ÖÖ 
new
ÖÖ 
ServiceResult
ÖÖ '
(
ÖÖ' (
)
ÖÖ( )
;
ÖÖ) *
if
ÜÜ 
(
ÜÜ 
skip
ÜÜ 
>=
ÜÜ 
$num
ÜÜ 
&&
ÜÜ 
pageSize
ÜÜ %
>
ÜÜ& '
$num
ÜÜ( )
)
ÜÜ) *
{
áá 
var
àà 
data
àà 
=
àà 
_dbSet
àà !
.
àà! "
Skip
àà" &
(
àà& '
skip
àà' +
)
àà+ ,
.
àà, -
Take
àà- 1
(
àà1 2
pageSize
àà2 :
)
àà: ;
;
àà; <
if
ââ 
(
ââ 
typeof
ââ 
(
ââ 
TEntity
ââ "
)
ââ" #
==
ââ$ &
typeof
ââ' -
(
ââ- .
House
ââ. 3
)
ââ3 4
)
ââ4 5
{
ää 
}
ãã 
res
åå 
.
åå 
Data
åå 
=
åå 
new
åå 
{
åå  
TotalRecords
åå! -
=
åå. /
totalRecords
åå0 <
,
åå< =
Data
åå> B
=
ååC D
data
ååE I
.
ååI J
ToList
ååJ P
(
ååP Q
)
ååQ R
}
ååS T
;
ååT U
}
çç 
return
éé 
res
éé 
;
éé 
}
èè 	
public
ëë 
bool
ëë 

DeleteById
ëë 
(
ëë 
string
ëë %
id
ëë& (
)
ëë( )
{
íí 	
_dbSet
ìì 
=
ìì 
_context
ìì 
.
ìì 
Set
ìì !
<
ìì! "
TEntity
ìì" )
>
ìì) *
(
ìì* +
)
ìì+ ,
;
ìì, -
var
îî 
res
îî 
=
îî 
$num
îî 
;
îî 
var
ïï 
entity
ïï 
=
ïï 
_dbSet
ïï 
.
ïï  
Find
ïï  $
(
ïï$ %
Guid
ïï% )
.
ïï) *
Parse
ïï* /
(
ïï/ 0
id
ïï0 2
)
ïï2 3
)
ïï3 4
;
ïï4 5
if
ññ 
(
ññ 
entity
ññ 
!=
ññ 
null
ññ 
)
ññ 
{
óó 
_dbSet
òò 
.
òò 
Remove
òò 
(
òò 
entity
òò $
)
òò$ %
;
òò% &
res
ôô 
=
ôô 
_context
ôô 
.
ôô 
SaveChanges
ôô *
(
ôô* +
)
ôô+ ,
;
ôô, -
}
öö 
return
õõ 
(
õõ 
res
õõ 
>
õõ 
$num
õõ 
?
õõ 
true
õõ "
:
õõ# $
false
õõ% *
)
õõ* +
;
õõ+ ,
}
úú 	
}
ùù 
}ûû ú&
sD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\DatabaseLayer\DLConversation.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 
DatabaseLayer +
{ 
public 

class 
DLConversation 
:  !
DLBase" (
<( )
Conversation) 5
,5 6
ConversationDTO7 F
>F G
,G H
IDLConversationI X
{ 
public 
DLConversation 
( 
WhereHouseContext /
context0 7
,7 8
IMapper9 @
mapperA G
)G H
:I J
baseK O
(O P
contextP W
,W X
mapperY _
)_ `
{ 	
} 	
public 
List 
< 
Conversation  
>  !"
GetAllConversationUser" 8
(8 9
string9 ?
userId@ F
)F G
{ 	
_dbSet 
= 
_context 
. 
Set !
<! "
Conversation" .
>. /
(/ 0
)0 1
;1 2
var 
data 
= 
_dbSet 
. 
Where #
(# $
x$ %
=>& (
() *
x* +
.+ ,
UserId1, 3
==4 6
Guid7 ;
.; <
Parse< A
(A B
userIdB H
)H I
)I J
||J L
(L M
xM N
.N O
UserId2O V
==W Y
GuidZ ^
.^ _
Parse_ d
(d e
userIde k
)k l
)l m
)m n
.n o
Includeo v
(v w
xw x
=>x z
xz {
.{ |
UserId1Navigation	| ç
)
ç é
.
é è
Include
è ñ
(
ñ ó
x
ó ò
=>
ò ö
x
ö õ
.
õ ú
UserId2Navigation
ú ≠
)
≠ Æ
;
Æ Ø
return 
data 
. 
ToList 
( 
)  
;  !
} 	
public 
override 
Conversation $
GetByID% ,
(, -
string- 3
Id4 6
)6 7
{ 	
_dbSet 
= 
_context 
. 
Set !
<! "
Conversation" .
>. /
(/ 0
)0 1
;1 2
var 
data 
= 
_dbSet 
. 
Where #
(# $
x$ %
=>& (
x) *
.* +
ConversationId+ 9
==: <
Guid= A
.A B
ParseB G
(G H
IdH J
)J K
)K L
.L M
IncludeM T
(T U
xU V
=>W Y
xZ [
.[ \
Messages\ d
)d e
.e f
FirstOrDefaultf t
(t u
)u v
;v w
return   
data   
;   
}!! 	
public## 
Conversation## 
GetConversation## +
(##+ ,
string##, 2
userId1##3 :
,##: ;
string##< B
userId2##C J
)##J K
{$$ 	
_dbSet%% 
=%% 
_context%% 
.%% 
Set%% !
<%%! "
Conversation%%" .
>%%. /
(%%/ 0
)%%0 1
;%%1 2
var&& 
id1&& 
=&& 
Guid&& 
.&& 
Parse&&  
(&&  !
userId1&&! (
)&&( )
;&&) *
var'' 
id2'' 
='' 
Guid'' 
.'' 
Parse''  
(''  !
userId2''! (
)''( )
;'') *
var(( 
data(( 
=(( 
_dbSet(( 
.(( 
Where(( #
(((# $
x(($ %
=>((& (
((() *
x((* +
.((+ ,
UserId1((, 3
==((4 6
id1((7 :
&&((; =
x((> ?
.((? @
UserId2((@ G
==((H J
id2((K N
)((N O
||((O Q
(((R S
x((S T
.((T U
UserId1((U \
==((] _
id2((` c
&&((d f
x((g h
.((h i
UserId2((i p
==((q s
id1((t w
)((w x
)((x y
.((y z
FirstOrDefault	((z à
(
((à â
)
((â ä
;
((ä ã
return)) 
data)) 
;)) 
}** 	
}++ 
},, ⁄
kD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\DatabaseLayer\DLFile.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 
DatabaseLayer +
{ 
public 

class 
DLFile 
: 
DLBase 
<  
File  $
,$ %
FileDTO& -
>- .
,. /
IDLFile0 7
{ 
public 
DLFile 
( 
WhereHouseContext '
context( /
,/ 0
IMapper1 8
mapper9 ?
)? @
:A B
baseC G
(G H
contextH O
,O P
mapperQ W
)W X
{ 	
} 	
} 
} ó
lD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\DatabaseLayer\DLHouse.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 
DatabaseLayer +
{ 
public 

class 
DLHouse 
: 
DLBase !
<! "
House" '
,' (
HouseDTO) 1
>1 2
,2 3
IDLHouse4 <
{ 
public 
DLHouse 
( 
WhereHouseContext (
context) 0
,0 1
IMapper2 9
mapper: @
)@ A
:B C
baseD H
(H I
contextI P
,P Q
mapperR X
)X Y
{ 	
} 	
public 
IEnumerable 
< 
House  
>  !
GetDeepData" -
(- .
). /
{ 	
_dbSet 
= 
_context 
. 
Set !
<! "
House" '
>' (
(( )
)) *
;* +
return 
_dbSet 
. 
Include !
(! "
x" #
=>$ &
x' (
.( )
	UserOwner) 2
)2 3
;3 4
} 	
} 
} ¯
pD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\DatabaseLayer\DLHouseType.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 
DatabaseLayer +
{ 
public 

class 
DLHouseType 
: 
DLBase %
<% &
	HouseType& /
,/ 0
HouseTypeDTO1 =
>= >
,> ?
IDLHouseType@ L
{ 
public 
DLHouseType 
( 
WhereHouseContext ,
context- 4
,4 5
IMapper6 =
mapper> D
)D E
:F G
baseH L
(L M
contextM T
,T U
mapperV \
)\ ]
{ 	
} 	
} 
} „
nD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\DatabaseLayer\DLMessage.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 
DatabaseLayer +
{ 
public 

class 
	DLMessage 
: 
DLBase #
<# $
Message$ +
,+ ,

MessageDTO- 7
>7 8
,8 9

IDLMessage: D
{ 
IDLUser 
_dLUser 
; 
public 
	DLMessage 
( 
WhereHouseContext *
context+ 2
,2 3
IMapper4 ;
mapper< B
,B C
IDLUserD K
dLUserL R
)R S
:T U
baseV Z
(Z [
context[ b
,b c
mapperd j
)j k
{ 	
_dLUser 
= 
dLUser 
; 
} 	
public 
object 
GetConversation %
(% &

MessageDTO& 0
message1 8
)8 9
{ 	
return 
null 
; 
}   	
public"" 
List"" 
<"" 
Message"" 
>"" '
GetMessagesByConversationId"" 8
(""8 9
string""9 ?
conversationId""@ N
)""N O
{## 	
_dbSet$$ 
=$$ 
_context$$ 
.$$ 
Set$$ !
<$$! "
Message$$" )
>$$) *
($$* +
)$$+ ,
;$$, -
var%% 
data%% 
=%% 
_dbSet%% 
.%% 
Where%% #
(%%# $
x%%$ %
=>%%& (
x%%) *
.%%* +
ConversationId%%+ 9
==%%: <
Guid%%= A
.%%A B
Parse%%B G
(%%G H
conversationId%%H V
)%%V W
)%%W X
;%%X Y
data&& 
=&& 
data&& 
.&& 
OrderBy&& 
(&&  
x&&  !
=>&&" $
x&&% &
.&&& '
Time&&' +
)&&+ ,
;&&, -
return'' 
data'' 
.'' 
ToList'' 
('' 
)''  
;''  !
}(( 	
})) 
}** Ê9
kD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\DatabaseLayer\DLPost.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 
DatabaseLayer +
{ 
public 

class 
DLPost 
: 
DLBase  
<  !
Post! %
,% &
PostDTO' .
>. /
,/ 0
IDLPost1 8
{ 
public 
DLPost 
( 
WhereHouseContext '
context( /
,/ 0
IMapper1 8
mapper9 ?
)? @
:A B
baseC G
(G H
contextH O
,O P
mapperQ W
)W X
{ 	
} 	
public 
override 
Post 
GetByID $
($ %
string% +
Id, .
). /
{ 	
_dbSet 
= 
_context 
. 
Set !
<! "
Post" &
>& '
(' (
)( )
;) *
var 
post 
= 
_dbSet 
. 
Where #
(# $
x$ %
=>& (
x) *
.* +
PostId+ 1
.1 2
ToString2 :
(: ;
); <
=== ?
Id@ B
)B C
. 
Include 
( 
x 
=> 
x 
. 
User "
)" #
.# $
Include$ +
(+ ,
x, -
=>. 0
x1 2
.2 3
House3 8
)8 9
.9 :
ThenInclude: E
(E F
houseF K
=>K M
houseM R
.R S
	HouseTypeS \
)\ ]
. 
Include 
( 
z 
=> 
z 
. 
House #
)# $
.$ %
ThenInclude% 0
(0 1
i1 2
=>2 4
i4 5
.5 6

HouseImage6 @
)@ A
. 
FirstOrDefault 
(  
)  !
;! "
return 
post 
; 
}   	
public!! 
override!! 
ServiceResult!! %
GetByPaging!!& 1
(!!1 2
int!!2 5
page!!6 :
,!!: ;
int!!< ?
pageSize!!@ H
)!!H I
{"" 	
_dbSet## 
=## 
_context## 
.## 
Set## !
<##! "
Post##" &
>##& '
(##' (
)##( )
;##) *
var$$ 
totalRecords$$ 
=$$ 
_dbSet$$ %
.$$% &
Count$$& +
($$+ ,
)$$, -
;$$- .
var%% 
skip%% 
=%% 
(%% 
page%% 
-%% 
$num%%  
)%%  !
*%%" #
pageSize%%$ ,
;%%, -
var&& 
res&& 
=&& 
new&& 
ServiceResult&& '
(&&' (
)&&( )
;&&) *
if'' 
('' 
skip'' 
>='' 
$num'' 
&&'' 
pageSize'' %
>''& '
$num''( )
)'') *
{(( 
var)) 
data)) 
=)) 
_dbSet)) !
.))! "
Skip))" &
())& '
skip))' +
)))+ ,
.)), -
Take))- 1
())1 2
pageSize))2 :
))): ;
.)); <
Include))< C
())C D
x))D E
=>))F H
x))I J
.))J K
House))K P
)))P Q
.))Q R
ThenInclude))R ]
())] ^
y))^ _
=>))` b
y))c d
.))d e

HouseImage))e o
)))o p
;))p q
res** 
.** 
Data** 
=** 
new** 
{**  
TotalRecords**! -
=**. /
totalRecords**0 <
,**< =
Data**> B
=**C D
data**E I
.**I J
ToList**J P
(**P Q
)**Q R
.**R S
OrderBy**S Z
(**Z [
x**[ \
=>**\ ^
x**^ _
.**_ `
CreatedDate**` k
)**k l
}**m n
;**n o
}++ 
return,, 
res,, 
;,, 
}-- 	
public// 
IEnumerable// 
<// 
Post// 
>//  
GetListPostForAdmin//! 4
(//4 5
)//5 6
{00 	
_dbSet11 
=11 
_context11 
.11 
Set11 !
<11! "
Post11" &
>11& '
(11' (
)11( )
;11) *
var22 
data22 
=22 
_dbSet22 
.22 
Include22 %
(22% &
x22& '
=>22( *
x22+ ,
.22, -
User22- 1
)221 2
.222 3
Include223 :
(22: ;
x22; <
=>22= ?
x22@ A
.22A B
House22B G
)22G H
.22H I
ThenInclude22I T
(22T U
house22U Z
=>22[ ]
house22^ c
.22c d
	HouseType22d m
)22m n
.33 
Include33 
(33 
z33 
=>33 
z33 
.33  
House33  %
)33% &
.33& '
ThenInclude33' 2
(332 3
i333 4
=>335 7
i338 9
.339 :

HouseImage33: D
)33D E
;33E F
return44 
data44 
;44 
}55 	
public77 
IEnumerable77 
<77 
Post77 
>77  
GetUserPost77! ,
(77, -
Guid77- 1
userId772 8
)778 9
{88 	
var99 
res99 
=99 
default99 
(99 
IEnumerable99 )
<99) *
Post99* .
>99. /
)99/ 0
;990 1
_dbSet:: 
=:: 
_context:: 
.:: 
Set:: !
<::! "
Post::" &
>::& '
(::' (
)::( )
;::) *
var;; 
data;; 
=;; 
_dbSet;; 
.;; 
Where;; #
(;;# $
x;;$ %
=>;;% '
x;;' (
.;;( )
UserId;;) /
==;;/ 1
userId;;1 7
);;7 8
;;;8 9
if<< 
(<< 
data<< 
!=<< 
null<< 
&&<< 
data<<  $
.<<$ %
Count<<% *
(<<* +
)<<+ ,
><<- .
$num<</ 0
)<<0 1
{<<2 3
res== 
=== 
data== 
.== 
Include== "
(==" #
x==# $
=>==% '
x==( )
.==) *
House==* /
)==/ 0
.==0 1
ThenInclude==1 <
(==< =
y=== >
=>==? A
y==B C
.==C D

HouseImage==D N
)==N O
;==O P
}>> 
return?? 
res?? 
;?? 
}AA 	
}BB 
}CC ∞
kD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\DatabaseLayer\DLUser.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 
DatabaseLayer +
{ 
public 

class 
DLUser 
: 
DLBase  
<  !
User! %
,% &
UserDTO' .
>. /
,/ 0
IDLUser1 8
{ 
public 
DLUser 
( 
WhereHouseContext '
context( /
,/ 0
IMapper1 8
mapper9 ?
)? @
:A B
baseC G
(G H
contextH O
,O P
mapperQ W
)W X
{ 	
} 	
public 
override 
User 
GetByID $
($ %
string% +
Id, .
). /
{ 	
_dbSet 
= 
_context 
. 
Set !
<! "
User" &
>& '
(' (
)( )
;) *
var 
data 
= 
_dbSet 
. 
Where #
(# $
x$ %
=>& (
x) *
.* +
UserId+ 1
==2 4
Guid5 9
.9 :
Parse: ?
(? @
Id@ B
)B C
)C D
.D E
IncludeE L
(L M
xM N
=>O Q
xR S
.S T
AvatarT Z
)Z [
.[ \
FirstOrDefault\ j
(j k
)k l
;l m
return 
data 
; 
} 	
public 
User 
GetUserByUserName %
(% &
string& ,
userName- 5
)5 6
{ 	
_dbSet 
= 
_context 
. 
Set !
<! "
User" &
>& '
(' (
)( )
;) *
var 
data 
= 
_dbSet 
. 
Where #
(# $
x$ %
=>& (
x) *
.* +
UserName+ 3
==4 6
userName7 ?
)? @
.@ A
IncludeA H
(H I
userI M
=>M O
userO S
.S T
AvatarT Z
)Z [
.[ \
FirstOrDefault\ j
(j k
)k l
;l m
return 
data 
; 
}   	
}!! 
}"" ¢
oD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\DatabaseLayer\DLWishlist.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 
DatabaseLayer +
{ 
public 

class 

DLWishlist 
: 
DLBase $
<$ %
Wishlist% -
,- .
WishlistDTO/ :
>: ;
,; <
IDLWishlist= H
{ 
public 

DLWishlist 
( 
WhereHouseContext +
context, 3
,3 4
IMapper5 <
mapper= C
)C D
:E F
baseG K
(K L
contextL S
,S T
mapperU [
)[ \
{ 	
} 	
public 
IEnumerable 
< 
Wishlist #
># $
GetWishlistByUserId% 8
(8 9
Guid9 =
userId> D
)D E
{ 	
var 
res 
= 
default 
( 
IEnumerable )
<) *
Wishlist* 2
>2 3
)3 4
;4 5
_dbSet 
= 
_context 
. 
Set !
<! "
Wishlist" *
>* +
(+ ,
), -
;- .
var 
data 
= 
_dbSet 
. 
Where #
(# $
x$ %
=>& (
x) *
.* +
UserId+ 1
==2 4
userId5 ;
); <
;< =
if 
( 
data 
!= 
null 
&& 
data  $
.$ %
Count% *
(* +
)+ ,
>- .
$num/ 0
)0 1
{ 
res 
= 
data 
. 
Include "
(" #
x# $
=>% '
x( )
.) *
Post* .
). /
./ 0
ThenInclude0 ;
(; <
post< @
=>A C
postD H
.H I
HouseI N
)N O
.O P
ThenIncludeP [
([ \
house\ a
=>a c
housec h
.h i

HouseImagei s
)s t
;t u
} 
return 
res 
; 
} 	
} 
}   ¶
rD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\DatabaseLayer\Login\DLLogin.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 
DatabaseLayer +
.+ ,
Login, 1
{ 
public 

class 
DLLogin 
: 
DLBase  
<  !

LoginParam! +
,+ ,

LoginParam, 6
>6 7
,7 8
IDLLogin9 A
{ 
public 
DLLogin 
( 
WhereHouseContext (
context) 0
,0 1
IMapper2 9
mapper: @
)@ A
:B C
baseD H
(H I
contextI P
,P Q
mapperR X
)X Y
{ 	
} 	
public 
LoginEntity 
Login  
(  !
string! '
Username( 0
)0 1
{ 	
var 
entity 
= 
new 
LoginEntity (
(( )
)) *
;* +
return 
entity 
; 
} 	
public 
int (
UpdatePasswordByEmployeeCode /
(/ 0
string0 6
employeecode7 C
,C D
stringE K
passwordL T
,T U
stringV \
salt] a
)a b
{ 	
var 
rows 
= 
$num 
; 
return 
rows 
; 
}   	
}"" 
}## ó
iD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\Interfaces\IDLBase.cs
	namespace		 	
PTDuc		
 
.		 

WhereHouse		 
.		 
DL		 
.		 

Interfaces		 (
{

 
public 

	interface 
IDLBase 
< 
TEntity $
,$ %
TDTO% )
>) *
{ 
IEnumerable 
< 
TDTO 
> 
GetAll  
(  !
)! "
;" #
TEntity 
GetByID 
( 
string 
Id !
)! "
;" #
bool 
Delete 
( 
TEntity 
entity "
)" #
;# $
bool 
Update 
( 
TEntity 
entity "
," #
string# )
id* ,
)- .
;. /
bool 
Insert 
( 
TEntity 
entity "
)" #
;# $
IEnumerable 
< 
TEntity 
> 
GetByKey %
(% &
string& ,
key- 0
,0 1
string2 8
value9 >
)> ?
;? @
TEntity 
GetOneByKey 
( 
string "
key# &
,& '
string( .
value/ 4
)4 5
;5 6
	TableName 
GetOneByKeyWithType %
<% &
	TableName& /
>/ 0
(0 1
PropertyInfo1 =
prop> B
,B C
TEntityD K
entityL R
)R S
whereT Y
	TableNameZ c
:d e
classf k
;k l
ServiceResult 
GetByPaging !
(! "
int" %
page& *
,* +
int, /
pageSize0 8
)8 9
;9 :
bool 

DeleteById 
( 
string 
id !
)! "
;" #
} 
} ò
qD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\Interfaces\IDLConversation.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 

Interfaces (
{ 
public 

	interface 
IDLConversation $
:% &
IDLBase' .
<. /
Conversation/ ;
,; <
ConversationDTO= L
>L M
{ 
Conversation		 
GetConversation		 $
(		$ %
string		% +
userId1		, 3
,		3 4
string		5 ;
userId2		< C
)		C D
;		D E
List

 
<

 
Conversation

 
>

 "
GetAllConversationUser

 1
(

1 2
string

2 8
userId

9 ?
)

? @
;

@ A
} 
} 
iD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\Interfaces\IDLFile.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 

Interfaces (
{		 
public

 

	interface

 
IDLFile

 
:

 
IDLBase

 %
<

% &
File

& *
,

* +
FileDTO

+ 2
>

2 3
{ 
} 
} Ñ
jD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\Interfaces\IDLHouse.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 

Interfaces (
{ 
public 

	interface 
IDLHouse 
: 
IDLBase  '
<' (
House( -
,- .
HouseDTO/ 7
>7 8
{ 
IEnumerable		 
<		 
House		 
>		 
GetDeepData		 &
(		& '
)		' (
;		( )
}

 
} Ñ
nD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\Interfaces\IDLHouseType.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 

Interfaces (
{ 
public 

	interface 
IDLHouseType !
:" #
IDLBase$ +
<+ ,
	HouseType, 5
,5 6
HouseTypeDTO7 C
>C D
{ 
} 
} “
lD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\Interfaces\IDLMessage.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 

Interfaces (
{ 
public 

	interface 

IDLMessage 
:  !
IDLBase" )
<) *
Message* 1
,1 2

MessageDTO3 =
>= >
{ 
object		 
GetConversation		 
(		 

MessageDTO		 )
message		* 1
)		1 2
;		2 3
List

 
<

 
Message

 
>

 '
GetMessagesByConversationId

 1
(

1 2
string

2 8
conversationId

9 G
)

G H
;

H I
} 
} ‰
iD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\Interfaces\IDLPost.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 

Interfaces (
{ 
public 

	interface 
IDLPost 
: 
IDLBase &
<& '
Post' +
,+ ,
PostDTO- 4
>4 5
{

 
public 
IEnumerable 
< 
Post 
>  
GetUserPost! ,
(, -
Guid- 1
userId2 8
)8 9
;9 :
public 
IEnumerable 
< 
Post 
>  
GetListPostForAdmin! 4
(4 5
)5 6
;6 7
} 
} ¯
iD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\Interfaces\IDLUser.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 

Interfaces (
{ 
public 

	interface 
IDLUser 
: 
IDLBase %
<% &
User& *
,* +
UserDTO, 3
>3 4
{ 
User 
GetUserByUserName 
( 
string %
userName& .
). /
;/ 0
}		 
}

 ’
mD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\Interfaces\IDLWishlist.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 

Interfaces (
{ 
public 

	interface 
IDLWishlist  
:! "
IDLBase# *
<* +
Wishlist+ 3
,3 4
WishlistDTO5 @
>@ A
{		 
public

 
IEnumerable

 
<

 
Wishlist

 #
>

# $
GetWishlistByUserId

% 8
(

8 9
Guid

9 =
userId

> D
)

D E
;

E F
} 
} ™
pD:\Tailieu\projectDoAn\Code\WhereHouse\Backend\PTDuc.WhereHouse\PTDuc.WhereHouse.DL\Interfaces\Login\IDLLogin.cs
	namespace 	
PTDuc
 
. 

WhereHouse 
. 
DL 
. 

Interfaces (
.( )
Login) .
{		 
public

 

	interface

 
IDLLogin

 
:

 
IDLBase

 %
<

% &

LoginParam

& 0
,

0 1

LoginParam

2 <
>

< =
{ 
LoginEntity 
Login 
( 
string  
Username! )
)) *
;* +
int (
UpdatePasswordByEmployeeCode (
(( )
string) /
employeecode0 <
,< =
string> D
passwordE M
,M N
stringO U
saltV Z
)Z [
;[ \
} 
} 